<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tarea3_2 • enriquepresa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tarea3_2">
<meta property="og:description" content="enriquepresa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">enriquepresa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PRJNA517180.html">PRJNA517180</a>
    </li>
    <li>
      <a href="../articles/tarea1.html">tarea1</a>
    </li>
    <li>
      <a href="../articles/tarea2.html">tarea2</a>
    </li>
    <li>
      <a href="../articles/tarea3_2.html">tarea3_2</a>
    </li>
    <li>
      <a href="../articles/tarea4_1.html">tarea4_1</a>
    </li>
    <li>
      <a href="../articles/tarea4_2.html">tarea4_2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tarea3_2</h1>
                        <h4 class="author">Enrique Presa</h4>
            
            <h4 class="date">23 junio, 2020</h4>
      
      
      <div class="hidden name"><code>tarea3_2.rmd</code></div>

    </div>

    
    
<div id="tarea-3_2-expresión-diferencial-con-edger" class="section level1">
<h1 class="hasAnchor">
<a href="#tarea-3_2-expresi%C3%B3n-diferencial-con-edger" class="anchor"></a>Tarea 3_2: Expresión diferencial con edgeR</h1>
<div id="carga-de-paquetes" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-de-paquetes" class="anchor"></a>Carga de paquetes</h2>
<p>Se cargan todos los paquetes que van a servir a lo largo del estudio. Utilizamos la funcion p_load del paquete pacman debido a que si no está el paquete en la librería intenta descargarlo desde CRAN u otro repositorio. También se guarda el directorio de trabajo en una variable para utilizarlo más adelante.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">pacman</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span>(<span class="no">edgeR</span>, <span class="no">enriquepresa</span>, <span class="no">ReportingTools</span>, <span class="no">SummarizedExperiment</span>)
<span class="no">wd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span>()</pre></body></html></div>
</div>
<div id="generación-del-objeto-dgelist" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-del-objeto-dgelist" class="anchor"></a>Generación del objeto DGEList</h2>
<p>En primer lugar, se carga el SummarizedExperiment y se eligen los grupos a comparar. Como ya se ha mencionado anteriormente se van a comparar las muestras control (con el vector L4440) con las muestras con el gen ztf-11 silenciado. Por último se hace el objeto DGEList.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">PRJNA517180</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"enriquepresa"</span>)
<span class="no">grupos</span> <span class="kw">=</span> <span class="fu">colData</span>(<span class="no">PRJNA517180</span>)[,<span class="st">"type"</span>]

<span class="no">x</span> <span class="kw">=</span> <span class="fu">DGEList</span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu">assay</span>(<span class="no">PRJNA517180</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="no">grupos</span>)</pre></body></html></div>
</div>
<div id="eliminación-de-genes-con-pocos-conteos" class="section level2">
<h2 class="hasAnchor">
<a href="#eliminaci%C3%B3n-de-genes-con-pocos-conteos" class="anchor"></a>Eliminación de genes con pocos conteos</h2>
<p>Como al final se va a utilizar una dispersión diferente para cada gen, ya que suponer una misma dispersión sobre una cantidad grande de genes no es muy razonable, se van a eliminar aquellos genes que tengan pocos conteos de tal manera que el coeficiente de variación de cada gen sea menor. Además, se ha observado que hay más genes con expresión diferencial y con un FDR más alto si se eliminan los genes con pocos conteos.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">keep</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="fu">cpm</span>(<span class="no">x</span>) <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="kw">&gt;=</span> <span class="fl">2</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="no">keep</span>, , <span class="kw">keep.lib.sizes</span> <span class="kw">=</span> <span class="fl">FALSE</span>]</pre></body></html></div>
</div>
<div id="cálculo-de-la-dispersión-común-y-la-dispersión-por-gen" class="section level2">
<h2 class="hasAnchor">
<a href="#c%C3%A1lculo-de-la-dispersi%C3%B3n-com%C3%BAn-y-la-dispersi%C3%B3n-por-gen" class="anchor"></a>Cálculo de la dispersión común y la dispersión por gen</h2>
<p>Lo siguiente será calcular la dispersión común y la dispersión por gen.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">dge.c</span> <span class="kw">=</span> <span class="fu">estimateCommonDisp</span>(<span class="no">x</span>)
<span class="no">dge.t</span> <span class="kw">=</span> <span class="fu">estimateTagwiseDisp</span>(<span class="no">dge.c</span>)</pre></body></html></div>
</div>
<div id="cálculo-del-test-exacto" class="section level2">
<h2 class="hasAnchor">
<a href="#c%C3%A1lculo-del-test-exacto" class="anchor"></a>Cálculo del test exacto</h2>
<p>El test exacto se calcula para la diferencia de medias entre dos grupos de conteos bajo una distribución binomial negativa. Por último, gracias a la función topTags se registran en una tabla los resultados.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">et.t</span> <span class="kw">=</span> <span class="fu">exactTest</span>(<span class="no">dge.t</span>)
<span class="no">df</span> <span class="kw">=</span> <span class="fu">topTags</span>(<span class="no">et.t</span>, <span class="kw">n</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">et.t</span>$<span class="no">table</span>))
<span class="no">df</span> <span class="kw">=</span> <span class="no">df</span>$<span class="no">table</span></pre></body></html></div>
</div>
<div id="generación-del-informe" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-del-informe" class="anchor"></a>Generación del informe</h2>
<p>Al igual que en el caso del estudio en microarrays, para que se pueda disponer de la información de manera más informativa, se van a añadir diferentes enlaces de ENTREZ y ENSEMBL al data frame generado con los genes expresados diferencialmente. Para ello se utilizará el <em>rowData</em> incorporado en la viñeta <em>tarea3_1</em>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">SYMBOL</span> <span class="kw">=</span> <span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">df</span>),<span class="st">"SYMBOL"</span>]
<span class="no">ENTREZ_URLs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">df</span>),<span class="st">"ENTREZID"</span>], <span class="no">entrezurl</span>)
<span class="no">ENSEMBL_URLs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">df</span>),<span class="st">"ENSEMBL"</span>], <span class="no">ensemblurl</span>)
<span class="no">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">SYMBOL</span>, <span class="no">df</span>, <span class="no">ENTREZ_URLs</span>, <span class="no">ENSEMBL_URLs</span>)</pre></body></html></div>
</div>
<div id="generación-de-un-informe-html" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-informe-html" class="anchor"></a>Generación de un informe html</h2>
<p>Se va a generar un fichero html con el data frame gracias al paquete <em>ReportingTools</em>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">foutput</span> <span class="kw">=</span> <span class="st">"PRJNA517180"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/differential_expression"</span>)

<span class="fu">publish</span>(<span class="no">df</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)</pre></body></html></div>
</div>
<div id="guardado-del-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#guardado-del-data-frame" class="anchor"></a>Guardado del data frame</h2>
<p>En el directorio <em>reports</em> se va a proceder a guardar este data frame con el resultado de la expresión diferencial.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">edgeR_df</span> <span class="kw">=</span> <span class="no">df</span>
<span class="no">dirReports</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">wd</span>,<span class="st">"/reports/"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">edgeR_df</span>, <span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">dirReports</span>,<span class="st">"edgeR_df.rda"</span>))</pre></body></html></div>
</div>
<div id="volcano-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#volcano-plot" class="anchor"></a>Volcano plot</h2>
<p>Al igual que en el caso del experimento de microarrays, en este experimento de RNA-seq se puede utilizar la funcion <em>enriquepresa::plot_volcano</em> incorporada en este paquete para observar en un gráfico los genes que se encuentran expresados diferencialmente.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_volcano.html">plot_volcano</a></span>(<span class="no">edgeR_df</span>$<span class="no">FDR</span>, <span class="no">edgeR_df</span>$<span class="no">logFC</span>, <span class="no">edgeR_df</span>$<span class="no">SYMBOL</span>, <span class="fl">0.05</span>, <span class="fl">1</span>)</pre></body></html></div>
<p>Como se puede observar, son muchos los genes que se encuentran sobreexpresados (224 genes para un p-valor menor a 0.05 y un <em>logFC</em> mayor a 1) y muy pocos los genes que se encuentran subexpresados (10 genes para un p-valor menor a 0.05 y un <em>logFC</em> menor a -1). Por tanto, se podría pensar que la inactivación del gen ztf-11 genera la activación de una gran cantidad de genes relacionados con la diferenciación a tejidos no neuronales, y también la inactivación de unos pocos genes relacionados con la diferenciación neuronal.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">edgeR_df</span>$<span class="no">FDR</span> <span class="kw">&lt;</span> <span class="fl">0.05</span> <span class="kw">&amp;</span> <span class="no">edgeR_df</span>$<span class="no">logFC</span> <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="co">#Número de genes sobreexpresados</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">edgeR_df</span>$<span class="no">FDR</span> <span class="kw">&lt;</span> <span class="fl">0.05</span> <span class="kw">&amp;</span> <span class="no">edgeR_df</span>$<span class="no">logFC</span> <span class="kw">&lt;</span> -<span class="fl">1</span>) <span class="co">#Número de genes subexpresados</span></pre></body></html></div>
<p>Para obtener conclusiones más claras, en las viñetas <em>tarea4_1</em> y <em>tarea4_2</em> se ha realizado un análisis de sobre-representación y un análisis de grupos de genes, respectivamente.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Enrique Presa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

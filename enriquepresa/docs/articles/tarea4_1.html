<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tarea4_1 • enriquepresa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tarea4_1">
<meta property="og:description" content="enriquepresa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">enriquepresa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PRJNA517180.html">PRJNA517180</a>
    </li>
    <li>
      <a href="../articles/tarea1.html">tarea1</a>
    </li>
    <li>
      <a href="../articles/tarea2.html">tarea2</a>
    </li>
    <li>
      <a href="../articles/tarea3_2.html">tarea3_2</a>
    </li>
    <li>
      <a href="../articles/tarea4_1.html">tarea4_1</a>
    </li>
    <li>
      <a href="../articles/tarea4_2.html">tarea4_2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tarea4_1</h1>
                        <h4 class="author">Enrique Presa</h4>
            
            <h4 class="date">23 junio, 2020</h4>
      
      
      <div class="hidden name"><code>tarea4_1.rmd</code></div>

    </div>

    
    
<div id="tarea-4_1-análisis-de-sobre-representación" class="section level1">
<h1 class="hasAnchor">
<a href="#tarea-4_1-an%C3%A1lisis-de-sobre-representaci%C3%B3n" class="anchor"></a>Tarea 4_1: Análisis de sobre-representación</h1>
</div>
<div id="análisis-de-prjna517180" class="section level1">
<h1 class="hasAnchor">
<a href="#an%C3%A1lisis-de-prjna517180" class="anchor"></a>Análisis de PRJNA517180</h1>
<div id="carga-de-paquetes" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-de-paquetes" class="anchor"></a>Carga de paquetes</h2>
<p>Se cargan todos los paquetes que van a servir a lo largo del estudio. Utilizamos la funcion p_load del paquete pacman debido a que si no está el paquete en la librería intenta descargarlo desde CRAN u otro repositorio.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">pacman</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span>(<span class="no">BiocGenerics</span>, <span class="no">EnrichmentBrowser</span>, <span class="no">enriquepresa</span>, <span class="no">ReportingTools</span>, <span class="no">SummarizedExperiment</span>)</pre></body></html></div>
</div>
<div id="carga-de-prjna517180-y-de-los-grupos-de-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-de-prjna517180-y-de-los-grupos-de-genes" class="anchor"></a>Carga de PRJNA517180 y de los grupos de genes</h2>
<p>En segundo lugar, es necesario cargar el SummarizedExperiment y el data frame con los datos de expresión diferencial obtenidos con <em>edgeR</em>. Ambos son necesarios para hacer el análisis de sobre-representación. También es necesario descargar los grupos de genes que se van a utilizar: los 3 tipos de ontologías de GO, que son Proceso Biológico (bp), Componente Celular (cc) y Función Molecular (mf).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">PRJNA517180</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"enriquepresa"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">edgeR_df</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"enriquepresa"</span>)

<span class="no">cel_go_bp</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"cel"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"BP"</span>)
<span class="no">cel_go_cc</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"cel"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"CC"</span>)
<span class="no">cel_go_mf</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"cel"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"MF"</span>)</pre></body></html></div>
</div>
<div id="cambios-necesarios-para-utilizar-la-función-sbea" class="section level2">
<h2 class="hasAnchor">
<a href="#cambios-necesarios-para-utilizar-la-funci%C3%B3n-sbea" class="anchor"></a>Cambios necesarios para utilizar la función sbea</h2>
<p>La función <em>EnrichmentBrowser::sbea</em> necesita que se hagan varios cambios en el SummarizedExperiment.</p>
<div id="quitar-filas-sin-identificador-entrez" class="section level4">
<h4 class="hasAnchor">
<a href="#quitar-filas-sin-identificador-entrez" class="anchor"></a>Quitar filas sin identificador ENTREZ</h4>
<p>En primer lugar, es necesario eliminar aquellas filas cuyos genes no tienen identificador de ENTREZ, tanto en el SummarizedExperiment como en el data frame. Por otra parte, en el SummarizedExperiment, se eliminan las filas para las cuales no hay información en el data frame obtenido con <em>edge R</em>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">PRJNA517180</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)$<span class="no">ENTREZID</span>)<span class="kw">==</span><span class="fl">FALSE</span>),]
<span class="no">edgeR_df</span> <span class="kw">=</span> <span class="no">edgeR_df</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">edgeR_df</span>$<span class="no">ENTREZ_URLs</span>)<span class="kw">==</span><span class="fl">FALSE</span>),]
<span class="no">PRJNA517180</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">edgeR_df</span>),]</pre></body></html></div>
</div>
<div id="quitar-filas-con-genes-repetidos" class="section level4">
<h4 class="hasAnchor">
<a href="#quitar-filas-con-genes-repetidos" class="anchor"></a>Quitar filas con genes repetidos</h4>
<p>Hay genes en notación WORMBASE que se refieren al mismo ENTREZ. Por tanto, de estos genes solo se elige el primero que aparezca. Para ello se utiliza la función <em>BiocGenerics::match</em>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">PRJNA517180</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)$<span class="no">ENTREZID</span>),<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)$<span class="no">ENTREZID</span>),]
<span class="no">edgeR_df</span> <span class="kw">=</span> <span class="no">edgeR_df</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">edgeR_df</span>$<span class="no">ENTREZ_URLs</span>), <span class="no">edgeR_df</span>$<span class="no">ENTREZ_URLs</span>),]</pre></body></html></div>
</div>
<div id="cambiar-los-nombres-de-las-filas-de-prjna517180-y-cambiar-el-rowdata" class="section level4">
<h4 class="hasAnchor">
<a href="#cambiar-los-nombres-de-las-filas-de-prjna517180-y-cambiar-el-rowdata" class="anchor"></a>Cambiar los nombres de las filas de PRJNA517180 y cambiar el rowData</h4>
<p>También es necesario poner como <em>rownames</em> el id de ENTREZ en vez del id de WORMBASE y meter el data frame de <em>edgeR</em> como <em>rowData</em>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">PRJNA517180</span>) <span class="kw">=</span> <span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">PRJNA517180</span>),<span class="st">"ENTREZID"</span>]
<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>) <span class="kw">=</span> <span class="no">edgeR_df</span></pre></body></html></div>
</div>
<div id="cambios-en-los-nombres-de-las-columnas-de-rowdata-y-coldata" class="section level4">
<h4 class="hasAnchor">
<a href="#cambios-en-los-nombres-de-las-columnas-de-rowdata-y-coldata" class="anchor"></a>Cambios en los nombres de las columnas de rowData y colData</h4>
<p>Por último, la función <em>EnrichmentBrowser::sbea</em> reconoce unos nombres en las columnas del <em>rowData</em> y <em>colData</em> determinadas.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu">rowData</span>(<span class="no">PRJNA517180</span>)) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SYBMOL"</span>, <span class="st">"FC"</span>, <span class="st">"logCPM"</span>, <span class="st">"PValue"</span>, <span class="st">"ADJ.PVAL"</span>, <span class="st">"ENTREZ_URLs"</span>, <span class="st">"ENSEMBL_URLs"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu">colData</span>(<span class="no">PRJNA517180</span>)) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Run"</span>, <span class="st">"GROUP"</span>)</pre></body></html></div>
</div>
</div>
<div id="análisis-de-sobre-representación" class="section level2">
<h2 class="hasAnchor">
<a href="#an%C3%A1lisis-de-sobre-representaci%C3%B3n" class="anchor"></a>Análisis de sobre-representación</h2>
<p>La función <em>EnrichmentBrowser::sbea</em> utiliza el test de Fisher, con el SummarizedExperiment PRJNA517180 y con los tres grupos de genes de GO mencionados anteriormente. El p-valor que se va a utilizar como límite es 0,05.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">PRJNA517180.gobp</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">cel_go_bp</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)
<span class="no">PRJNA517180.gocc</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">cel_go_cc</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)
<span class="no">PRJNA517180.gomf</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">PRJNA517180</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">cel_go_mf</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)</pre></body></html></div>
</div>
<div id="visualización-de-los-resultados-obtenidos" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizaci%C3%B3n-de-los-resultados-obtenidos" class="anchor"></a>Visualización de los resultados obtenidos</h2>
<p>Para visualizar los datos obtenidos se va a utilizar la función <em>EnrichmentBrowser::gsRanking</em>. En dicha función, por defecto, muestra aquellos grupos para los que haya un p-valor menor a 0,05. Se cambia el nombre de las filas de dicho data frame para poder incluir las URLs a GO, como se verá a continuación.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">PRJNA517180.gobp</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">PRJNA517180.gobp</span>)
<span class="no">PRJNA517180.gocc</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">PRJNA517180.gocc</span>)
<span class="no">PRJNA517180.gomf</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">PRJNA517180.gomf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">PRJNA517180.gobp</span>) <span class="kw">=</span> <span class="no">PRJNA517180.gobp</span>[,<span class="st">"GENE.SET"</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">PRJNA517180.gocc</span>) <span class="kw">=</span> <span class="no">PRJNA517180.gocc</span>[,<span class="st">"GENE.SET"</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">PRJNA517180.gomf</span>) <span class="kw">=</span> <span class="no">PRJNA517180.gomf</span>[,<span class="st">"GENE.SET"</span>]</pre></body></html></div>
</div>
<div id="generación-de-un-informe-con-reporting-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-informe-con-reporting-tools" class="anchor"></a>Generación de un informe con reporting tools</h2>
<p>Se va a generar un fichero html con el data frame gracias al paquete <em>ReportingTools</em>. Antes de ello, se va a utilizar la función <em>enriquepresa:dfGO</em> para generar un data frame con URLs para los términos de GO.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">PRJNA517180_ora.gobp</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">PRJNA517180.gobp</span>)
<span class="no">PRJNA517180_ora.gocc</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">PRJNA517180.gocc</span>)
<span class="no">PRJNA517180_ora.gomf</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">PRJNA517180.gomf</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">PRJNA517180_ora.gobp</span>) <span class="co">#Un ejemplo de como queda con las URLs</span>

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"PRJNA517180_ora.gobp"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">PRJNA517180_ora.gobp</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"PRJNA517180_ora.gocc"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">PRJNA517180_ora.gocc</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"PRJNA517180_ora.gomf"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">PRJNA517180_ora.gomf</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)</pre></body></html></div>
<p>En el estudio realizado, que se puede consultar en <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6684318/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6684318/</a>, se ha realizado un análisis de sobre-representación similar. Tanto en ese estudio como en esta viñeta se observan algunos términos en común: respuesta inmunitaria, respuesta a estrés, términos relacionados con el citoesqueleto, y términos relacionados con el desarrollo de tejido muscular y epidérmico. Por tanto, este análisis de sobre-representación parece concordar con la hipótesis de partida, ya que al dejar de funcionar el gen ztf-11 se sobreexpresan genes relacionados con el desarrollo de otros tejidos que no sean tejido neuronal.</p>
</div>
</div>
<div id="análisis-de-gse50467" class="section level1">
<h1 class="hasAnchor">
<a href="#an%C3%A1lisis-de-gse50467" class="anchor"></a>Análisis de GSE50467</h1>
<div id="carga-de-eset50467-y-de-los-grupos-de-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-de-eset50467-y-de-los-grupos-de-genes" class="anchor"></a>Carga de Eset50467 y de los grupos de genes</h2>
<p>Se carga el ExpressionSet y los grupos de genes que se van a utilizar: los 3 tipos de ontologías de GO. El data frame con los datos de expresión diferencial no va a hacer falta porque se va a volver a realizar de forma sencilla.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Eset50467</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"enriquepresa"</span>)

<span class="no">hsa_go_bp</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"hsa"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"BP"</span>)
<span class="no">hsa_go_cc</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"hsa"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"CC"</span>)
<span class="no">hsa_go_mf</span> <span class="kw">=</span> <span class="fu">getGenesets</span>(<span class="kw">org</span> <span class="kw">=</span> <span class="st">"hsa"</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="st">"go"</span>, <span class="kw">go.onto</span> <span class="kw">=</span> <span class="st">"MF"</span>)</pre></body></html></div>
</div>
<div id="generación-de-un-summarizedexperiment-y-del-procedimiento-de-limma" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-summarizedexperiment-y-del-procedimiento-de-limma" class="anchor"></a>Generación de un SummarizedExperiment y del procedimiento de limma</h2>
<p>En primer lugar es necesario transformar el ExpressionSet a SummarizedExperiment y hacer algunos cambios para poder hacer el análisis de expresión diferencial con limma: cambiar los <em>rownames</em> del SummarizedExperiment a identificadores ENTREZ y añadir un grupo al <em>colData</em> con 0 y 1.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">se50467</span> <span class="kw">=</span> <span class="fu">makeSummarizedExperimentFromExpressionSet</span>(<span class="no">Eset50467</span>)
<span class="no">se50467</span> <span class="kw">=</span> <span class="fu">probe2gene</span>(<span class="no">se50467</span>)
<span class="no">GROUP</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">6</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">6</span>))
<span class="fu">colData</span>(<span class="no">se50467</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu">colData</span>(<span class="no">se50467</span>), <span class="no">GROUP</span>)
<span class="no">se50467</span> <span class="kw">=</span> <span class="fu">deAna</span>(<span class="kw">expr</span> <span class="kw">=</span> <span class="no">se50467</span>, <span class="kw">de.method</span> <span class="kw">=</span> <span class="st">"limma"</span>)</pre></body></html></div>
</div>
<div id="análisis-de-sobre-representación-1" class="section level2">
<h2 class="hasAnchor">
<a href="#an%C3%A1lisis-de-sobre-representaci%C3%B3n-1" class="anchor"></a>Análisis de sobre-representación</h2>
<p>Como ya se ha mencionado se va a utilizar la función <em>EnrichmentBrowser::sbea</em>. Se utiliza el test de Fisher, con el SummarizedExperiment se50467 y con los tres grupos de genes de GO mencionados anteriormente. El p-valor que se va a utilizar como límite es 0,05.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">se50467.gobp</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">se50467</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">hsa_go_bp</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)
<span class="no">se50467.gocc</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">se50467</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">hsa_go_cc</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)
<span class="no">se50467.gomf</span> <span class="kw">=</span> <span class="fu">sbea</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ora"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="no">se50467</span>, <span class="kw">gs</span> <span class="kw">=</span> <span class="no">hsa_go_mf</span>, <span class="kw">perm</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>)</pre></body></html></div>
</div>
<div id="visualización-de-los-resultados-obtenidos-1" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizaci%C3%B3n-de-los-resultados-obtenidos-1" class="anchor"></a>Visualización de los resultados obtenidos</h2>
<p>Para visualizar los datos obtenidos se va a utilizar la función <em>EnrichmentBrowser::gsRanking</em>. En dicha función, por defecto, muestra aquellos grupos para los que haya un p-valor menor a 0,05. Al igual que antes, se cambia el nombre de las filas para poder introducir las URLs de GO.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">se50467.gobp</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">se50467.gobp</span>)
<span class="no">se50467.gocc</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">se50467.gocc</span>)
<span class="no">se50467.gomf</span> <span class="kw">=</span> <span class="fu">gsRanking</span>(<span class="no">se50467.gomf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">se50467.gobp</span>) <span class="kw">=</span> <span class="no">se50467.gobp</span>[,<span class="st">"GENE.SET"</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">se50467.gocc</span>) <span class="kw">=</span> <span class="no">se50467.gocc</span>[,<span class="st">"GENE.SET"</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">se50467.gomf</span>) <span class="kw">=</span> <span class="no">se50467.gomf</span>[,<span class="st">"GENE.SET"</span>]</pre></body></html></div>
</div>
<div id="generación-de-un-informe-con-reporting-tools-1" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-informe-con-reporting-tools-1" class="anchor"></a>Generación de un informe con reporting tools</h2>
<p>Se va a generar un fichero html con los data frames obtenidos después del análisis de sobre-representación gracias al paquete <em>ReportingTools</em>. Antes de ello, se va a utilizar la función <em>enriquepresa:dfGO</em> para generar un data frame con URLs para los términos de GO.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">se50467_ora.gobp</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">se50467.gobp</span>)
<span class="no">se50467_ora.gocc</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">se50467.gocc</span>)
<span class="no">se50467_ora.gomf</span> <span class="kw">=</span> <span class="kw pkg">enriquepresa</span><span class="kw ns">::</span><span class="fu"><a href="../reference/dfGO.html">dfGO</a></span>(<span class="no">se50467.gomf</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">se50467_ora.gobp</span>)

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"se50467_ora.gobp"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">se50467_ora.gobp</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"se50467_ora.gocc"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">se50467_ora.gocc</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)

<span class="no">foutput</span> <span class="kw">=</span> <span class="st">"se50467_ora.gomf"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/ora"</span>)

<span class="fu">publish</span>(<span class="no">se50467_ora.gomf</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)</pre></body></html></div>
<p>Este análisis de sobre-representación muestra que hay expresión diferencial en genes relacionados con el splicing y la modificación postraduccional de RNA, lo que es lógico debido a que el gen SRSF2 está relacionado con el splicing de RNA. Además, también han aparecido términos relacionados con la reparación del DNA y del control del ciclo celular, de forma general, lo que también es lógico debido a que se está estudiando cómo influye la sobreexpresión del gen SRSF2 en células cancerígenas, y los procesos tumorales aparecen como consecuencia de problemas en el control del ciclo celular o de la reparación del DNA.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Enrique Presa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

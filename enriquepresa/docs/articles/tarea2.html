<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tarea2 • enriquepresa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tarea2">
<meta property="og:description" content="enriquepresa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">enriquepresa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PRJNA517180.html">PRJNA517180</a>
    </li>
    <li>
      <a href="../articles/tarea1.html">tarea1</a>
    </li>
    <li>
      <a href="../articles/tarea2.html">tarea2</a>
    </li>
    <li>
      <a href="../articles/tarea3_2.html">tarea3_2</a>
    </li>
    <li>
      <a href="../articles/tarea4_1.html">tarea4_1</a>
    </li>
    <li>
      <a href="../articles/tarea4_2.html">tarea4_2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tarea2</h1>
                        <h4 class="author">Enrique Presa</h4>
            
            <h4 class="date">23 junio, 2020</h4>
      
      
      <div class="hidden name"><code>tarea2.rmd</code></div>

    </div>

    
    
<div id="tarea-2" class="section level1">
<h1 class="hasAnchor">
<a href="#tarea-2" class="anchor"></a>Tarea 2</h1>
<div id="carga-de-paquetes" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-de-paquetes" class="anchor"></a>Carga de paquetes</h2>
<p>Cargamos todos los paquetes que van a servir a lo largo del estudio. Utilizamos la funcion p_load del paquete pacman debido a que si no está el paquete en la librería intenta descargarlo desde CRAN u otro repositorio.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">pacman</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span>(<span class="no">Biobase</span>, <span class="no">enriquepresa</span>, <span class="no">genefilter</span>, <span class="no">limma</span>, <span class="no">ReportingTools</span>)</pre></body></html></div>
</div>
<div id="carga-del-expression-set" class="section level2">
<h2 class="hasAnchor">
<a href="#carga-del-expression-set" class="anchor"></a>Carga del Expression set</h2>
<p>En primer lugar es necesario cargar el Expression set del estudio en cuestión, que es el GSE50467, y que ya ha sido normalizado y que ha pasado unos controles de calidad.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Eset50467</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"enriquepresa"</span>)</pre></body></html></div>
</div>
<div id="t-test-con-varianzas-iguales" class="section level2">
<h2 class="hasAnchor">
<a href="#t-test-con-varianzas-iguales" class="anchor"></a>T-test con varianzas iguales</h2>
<p>En primer lugar, se va a observar qué genes se expresan diferencialmente mediante un t-test suponiendo varianzas iguales. Los dos grupos que tiene este experimento para comparar son ambos líneas celulares idénticas pero a un grupo no se le ha aplicado ningún compuesto y al otro se le ha aplicado doxiciclina para sobreexpresar el gen SRSF2, y se quiere estudiar qué genes se ven afectados por este cambio en la expresión de este gen. Por tanto, se va a hacer un test-t para cada sonda del microarray teniendo en cuenta estos dos grupos. Se va a hacer mediante la función <em>rowttests</em> del paquete genefilter, y se va a obtener un primer data frame en el que se observa el valor del estadístico t,la diferencia de medias de cada grupo (<em>dm</em>) y el p-valor observado para cada sonda. El nombre de las filas es el <em>probe id</em>. En realidad, la columna <em>dm</em> debería ser llamada <em>LogFC</em>, debido a que el Expression Set ya tiene el logaritmo en base 2 de la expresión debido a una corrección de fondo que se ha hecho en el Expression Set de tipo <em>normexp</em>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">grupos</span> <span class="kw">=</span> <span class="fu">pData</span>(<span class="no">Eset50467</span>)[,<span class="st">"FactorValue..compound."</span>]
<span class="no">genefilter_df</span> <span class="kw">=</span> <span class="fu">rowttests</span>(<span class="no">Eset50467</span>, <span class="no">grupos</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">genefilter_df</span>)[<span class="fl">2</span>] <span class="kw">=</span> <span class="st">"LogFC"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">genefilter_df</span>)</pre></body></html></div>
<div id="comparaciones-múltiples" class="section level4">
<h4 class="hasAnchor">
<a href="#comparaciones-m%C3%BAltiples" class="anchor"></a>Comparaciones múltiples</h4>
<p>Debido a que no se hace una sola observación, sino que se hace tantas observaciones como sondas válidas tenga el microarray, es necesario hacer un ajuste del p-valor, tanto por el método de Benjamini-Hochberg, como por el método de Bonferroni, que es más conservador.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">BH</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span>(<span class="no">genefilter_df</span>$<span class="no">p.value</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"BH"</span>)
<span class="no">Bonferroni</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span>(<span class="no">genefilter_df</span>$<span class="no">p.value</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"bonferroni"</span>)
<span class="no">genefilter_df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">genefilter_df</span>, <span class="no">BH</span>, <span class="no">Bonferroni</span>)
<span class="no">genefilter_df</span> <span class="kw">=</span> <span class="no">genefilter_df</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">BH</span>),] <span class="co">#Se ordenan las filas en orden decreciente según el adj. p-value según el método BH</span></pre></body></html></div>
</div>
<div id="obtención-de-urls-a-entrez-y-ensembl" class="section level4">
<h4 class="hasAnchor">
<a href="#obtenci%C3%B3n-de-urls-a-entrez-y-ensembl" class="anchor"></a>Obtención de URL’s a ENTREZ y ENSEMBL</h4>
<p>Para obtener un estudio más explicativo, es necesario que el investigador al que se le van a pasar los resultados tenga un acceso directo a la información que pueden incorporar ENTREZ y ENSEMBL, por lo que será necesario incorporar las URL’s de los genes a ENTREZ y ENSEMBL. Para ello, se han utilizado dos funciones homólogas a las dos incorporadas en el paquete <em>tami</em>. Por otra parte, también se considera necesario incorporar el nombre del gen al data frame (<em>SYMBOL</em> en el fData).</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">fd</span> <span class="kw">=</span> <span class="fu">fData</span>(<span class="no">Eset50467</span>)
<span class="no">entrezids</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">genefilter_df</span>), <span class="kw">function</span>(<span class="no">x</span>){<span class="no">fd</span>[<span class="no">fd</span>$<span class="no">PROBEID</span><span class="kw">==</span><span class="no">x</span>,<span class="st">"ENTREZID"</span>]})
<span class="no">ENTREZ_URL</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">entrezids</span>, <span class="no">entrezurl</span>)
<span class="no">ensemblids</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">genefilter_df</span>), <span class="kw">function</span>(<span class="no">x</span>){<span class="no">fd</span>[<span class="no">fd</span>$<span class="no">PROBEID</span><span class="kw">==</span><span class="no">x</span>,<span class="st">"ENSEMBL"</span>]})
<span class="no">ENSEMBL_URL</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">ensemblids</span>, <span class="no">ensemblurl</span>)
<span class="no">SYMBOL</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">genefilter_df</span>), <span class="kw">function</span>(<span class="no">x</span>){<span class="no">fd</span>[<span class="no">fd</span>$<span class="no">PROBEID</span><span class="kw">==</span><span class="no">x</span>,<span class="st">"SYMBOL"</span>]})

<span class="no">genefilter_df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">SYMBOL</span>, <span class="no">genefilter_df</span>, <span class="no">ENTREZ_URL</span>, <span class="no">ENSEMBL_URL</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">genefilter_df</span>)</pre></body></html></div>
</div>
<div id="generación-de-un-fichero-html" class="section level4">
<h4 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-fichero-html" class="anchor"></a>Generación de un fichero html</h4>
<p>Por último, se va a generar un fichero html con el data frame gracias al paquete <em>ReportingTools</em>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">foutput</span> <span class="kw">=</span> <span class="st">"GSE50467_rowttests"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/differential_expression"</span>)

<span class="fu">publish</span>(<span class="no">genefilter_df</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)</pre></body></html></div>
</div>
<div id="guardado-del-data-frame" class="section level4">
<h4 class="hasAnchor">
<a href="#guardado-del-data-frame" class="anchor"></a>Guardado del data frame</h4>
<p>También se procede a guardar el data frame en el subdirectorio <em>reports</em> del paquete.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">genefilter_df</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"./reports/genefilter_df.rda"</span>, <span class="kw">compress</span> <span class="kw">=</span> <span class="st">"xz"</span>)</pre></body></html></div>
</div>
</div>
<div id="t-test-moderado" class="section level2">
<h2 class="hasAnchor">
<a href="#t-test-moderado" class="anchor"></a>T-test moderado</h2>
<p>Ahora se va a realizar un estudio muy similar pero en este caso se va a hacer un test-t moderado (sin suponer varianzas iguales). Para ello, se va a utilizar el paquete limma.</p>
<div id="generación-de-la-matriz-de-diseño" class="section level4">
<h4 class="hasAnchor">
<a href="#generaci%C3%B3n-de-la-matriz-de-dise%C3%B1o" class="anchor"></a>Generación de la matriz de diseño</h4>
<p>En primer lugar, es necesario hacer una matriz de diseño con los dos grupos a comparar.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">grupos</span><span class="kw">=</span> <span class="fu">pData</span>(<span class="no">Eset50467</span>)[,<span class="st">"FactorValue..compound."</span>]
<span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~<span class="fl">0</span>+<span class="no">grupos</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">design</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"doxycycline"</span>, <span class="st">"control"</span>)
<span class="no">design</span></pre></body></html></div>
</div>
<div id="ajuste-de-modelo-y-generación-de-contrastes" class="section level4">
<h4 class="hasAnchor">
<a href="#ajuste-de-modelo-y-generaci%C3%B3n-de-contrastes" class="anchor"></a>Ajuste de modelo y generación de contrastes</h4>
<p>En segundo lugar es necesario ajustar el modelo y hacer el contraste que queremos observar: muestras con doxiciclina contra muestras control.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">fit</span> <span class="kw">=</span> <span class="fu">lmFit</span>(<span class="no">Eset50467</span>, <span class="no">design</span>)
<span class="no">cont.matrix</span> <span class="kw">&lt;-</span> <span class="fu">makeContrasts</span>(<span class="no">doxycycline</span> - <span class="no">control</span>, <span class="kw">levels</span><span class="kw">=</span><span class="no">design</span>)</pre></body></html></div>
</div>
<div id="estimación-con-limma" class="section level4">
<h4 class="hasAnchor">
<a href="#estimaci%C3%B3n-con-limma" class="anchor"></a>Estimación con limma</h4>
<p>Por último se hace la estimación con limma utilizando la función eBayes y se ajusta el p-valor para comparaciones múltiples tanto por el método de Bonferroni como por el de Benjamini-Hochberg.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">fit2</span> <span class="kw">&lt;-</span> <span class="fu">contrasts.fit</span>(<span class="no">fit</span>, <span class="no">cont.matrix</span>)
<span class="no">fit2</span> <span class="kw">&lt;-</span> <span class="fu">eBayes</span>(<span class="no">fit2</span>)
<span class="no">tT</span> <span class="kw">&lt;-</span> <span class="fu">topTable</span>(<span class="no">fit2</span>, <span class="kw">coef</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="st">"BH"</span>, <span class="kw">number</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">Eset50467</span>))
<span class="no">tT2</span> <span class="kw">&lt;-</span> <span class="fu">topTable</span>(<span class="no">fit2</span>, <span class="kw">coef</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="st">"bonferroni"</span>, <span class="kw">number</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">Eset50467</span>))</pre></body></html></div>
</div>
</div>
<div id="generación-del-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#generaci%C3%B3n-del-data-frame" class="anchor"></a>Generación del data frame</h2>
<p>Para generar un data frame con la información más importante, es necesario quedarnos con el nombre del gen, el estadístico t, el log-fold change, el p-valor y los p-valores ajustados tanto por el método de Bonferroni como por el de Benjamini-Hochberg, además de las URL’s para ENTREZ y ENSEMBL para cada gen, de tal manera que sea un data frame explicativo y con el que un investigador pueda obtener información fácil y directamente.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">entrezurls</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">tT</span>$<span class="no">ENTREZID</span>, <span class="no">entrezurl</span>)
<span class="no">ensemblurls</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">tT</span>$<span class="no">ENSEMBL</span>, <span class="no">ensemblurl</span>)
<span class="no">limma_df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">SYMBOL</span> <span class="kw">=</span> <span class="no">tT</span>$<span class="no">SYMBOL</span>, <span class="kw">statistic</span> <span class="kw">=</span> <span class="no">tT</span>$<span class="no">t</span>, <span class="kw">LogFC</span><span class="kw">=</span><span class="no">tT</span>$<span class="no">logFC</span>, <span class="kw">p.value</span><span class="kw">=</span><span class="no">tT</span>$<span class="no">P.Value</span>,
                <span class="kw">BH</span><span class="kw">=</span><span class="no">tT</span>$<span class="no">adj.P.Val</span>, <span class="kw">Bonferroni</span><span class="kw">=</span><span class="no">tT2</span>$<span class="no">adj.P.Val</span>, <span class="kw">ENTREZ_URL</span><span class="kw">=</span><span class="no">entrezurls</span>, <span class="kw">ENSEMBL_URL</span><span class="kw">=</span><span class="no">ensemblurls</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">limma_df</span>) <span class="kw">=</span> <span class="no">tT</span>$<span class="no">PROBEID</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">limma_df</span>)</pre></body></html></div>
<div id="generación-de-un-fichero-html-1" class="section level4">
<h4 class="hasAnchor">
<a href="#generaci%C3%B3n-de-un-fichero-html-1" class="anchor"></a>Generación de un fichero html</h4>
<p>Al igual que antes, se va a generar un fichero html con el data frame gracias al paquete <em>ReportingTools</em>.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">foutput</span> <span class="kw">=</span> <span class="st">"GSE50467_limma"</span>
<span class="no">htmlRep1</span> <span class="kw">=</span> <span class="fu">HTMLReport</span>(<span class="kw">shortName</span> <span class="kw">=</span> <span class="no">foutput</span>,<span class="kw">title</span> <span class="kw">=</span> <span class="no">foutput</span>,
                      <span class="kw">reportDirectory</span> <span class="kw">=</span> <span class="st">"./reports/differential_expression"</span>)

<span class="fu">publish</span>(<span class="no">limma_df</span>, <span class="no">htmlRep1</span>)
<span class="fu">finish</span>(<span class="no">htmlRep1</span>)</pre></body></html></div>
</div>
<div id="guardado-del-data-frame-1" class="section level4">
<h4 class="hasAnchor">
<a href="#guardado-del-data-frame-1" class="anchor"></a>Guardado del data frame</h4>
<p>También se procede a guardar el data frame en el subdirectorio <em>reports</em> del paquete, al igual que antes.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">limma_df</span>, <span class="kw">file</span><span class="kw">=</span><span class="st">"./reports/limma_df.rda"</span>, <span class="kw">compress</span> <span class="kw">=</span> <span class="st">"xz"</span>)</pre></body></html></div>
</div>
</div>
<div id="volcano-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#volcano-plot" class="anchor"></a>Volcano plot</h2>
<p>Para observar los datos se va a realizar un Volcano plot gracias a una función incorporada en este paquete. Un volcano plot es un tipo de representación en el que como valor de abscisas se representa el log-fold change y como valor de ordenada se representa el valor opuesto al logaritmo en base 10 del p-valor. Todo esto para cada gen, de tal manera que nos hacemos una idea de todos los genes que se expresan de forma diferencial por encima de un límite establecido y con un p-valor menor a uno dado. Como ejemplo se utilizará el ajuste de Benjamini-Hochberg y se marcarán aquellos genes que tengan se expresen el doble en el control o en el caso (por tanto logFC=1) y con un p-valor menor a 0.05.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_volcano.html">plot_volcano</a></span>(<span class="no">genefilter_df</span>$<span class="no">BH</span>, <span class="no">genefilter_df</span>$<span class="no">LogFC</span>, <span class="no">genefilter_df</span>$<span class="no">SYMBOL</span>, <span class="kw">min_p</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="kw">diff</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>Un logFC mínimo de 1 ya indica que el gen se sobreexprese el doble en un grupo o en otro, lo que se puede considerar bastante alto. En la publicación relacionada con el estudio GSE50467, como se detalla, buscan la expresión diferencial de genes que intervengan en la diferenciación y crecimiento celular, debido a que están estudiando un adenocarcinoma pulmonar. Por esa razón, los dos genes principales en los que observan regulación son VEGFA (sobreexpresado 1.67 veces) y EGFR (subexpresado 1.87 veces).</p>
<p>Con el procesamiento de datos hecho en este análisis se obtiene que el gen VEGFA está sobreexpresado 1.692 veces y que el gen EGFR está subexpresado 1.322 veces. Como se puede observar, para el gen VEGFA obtenemos un valor similar, pero para el gen EGFR en este caso no hay tanto cambio de expresión como afirman en la publicación.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fl">2</span>^(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">limma_df</span>[<span class="no">limma_df</span>$<span class="no">SYMBOL</span><span class="kw">==</span><span class="st">"VEGFA"</span>,<span class="st">"LogFC"</span>]))
<span class="fl">1</span>/(<span class="fl">2</span>^(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">limma_df</span>[<span class="no">limma_df</span>$<span class="no">SYMBOL</span><span class="kw">==</span><span class="st">"EGFR"</span>,<span class="st">"LogFC"</span>])))</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Enrique Presa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
